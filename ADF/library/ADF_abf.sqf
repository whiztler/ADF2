/*********************************************************************************
 _____ ____  _____ 
|  _  |    \|   __|
|     |  |  |   __|
|__|__|____/|__|   
ARMA Mission Development Framework
ADF version: 2.00 / MARCH 2016

Script: Altitude Based Fatigue (ABF)
Author: Whiztler
Script version: 1.10

File: ADF_ABF.sqf
**********************************************************************************
DO NOT edit this file. To set-up and configure your mission, edit the files in
the  'mission\1-config\'  folder.
********************************************************************************/

#include "\ADF\ADF_macros.hpp"
ADF__ERPT("ADF_ABF.sqf");

if (!hasInterface) exitWith {}; // clients only - double check

// Init
private _u 	= player;
private _f1	= 1.10 + random 0.05;	// 10%
private _f2	= 1.20 + random 0.05; 	// 25%
private _f3	= 1.40 + random 0.10; 	// 50%
private _f4	= 1.60 + random 0.10; 	// 75
private _f5	= 2; 					// 125
private _s	= 60;					// runs every xx seconds
private _f 	= [];

_u enableFatigue true;
ADF_ABF = true;

ADF_fnc_ABF_update = {
	ADF__P1(_u);

	private _f	= getFatigue _u;
	private _h	= getPosASL _u;

	[_h select 2, _f]	
};

waitUntil {
	private _a = [_u] call ADF_fnc_ABF_update;
	if !((vehicle player) isKindOf "Air") then {
		if (_a select 0 <= 1500) then {player setFatigue (_a select 1)};
		if ((_a select 0 > 1500) && (_a select 0 <= 2000)) then {player setFatigue (_a select 1) * _f1};
		if ((_a select 0 > 2000) && (_a select 0 <= 3000)) then {player setFatigue (_a select 1) * _f2};
		if ((_a select 0 > 3000) && (_a select 0 <= 4000)) then {player setFatigue (_a select 1) * _f3};
		if ((_a select 0 > 4000) && (_a select 0 <= 5000)) then {player setFatigue (_a select 1) * _f4};
		if (_a select 0 > 5000)  then {player setFatigue (_a select 1) * _f5};
		if ((getFatigue _u) >= 1) then {player setFatigue 1};
	};
	sleep _s;
	(!alive _u)
};